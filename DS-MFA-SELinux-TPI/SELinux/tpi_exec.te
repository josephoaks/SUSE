# TPI SELinux policy
# File location: "/usr/share/selinux/packages/tpi_exec"

module tpi_exec 1.0;

require {
    type bin_t;
    class file { read open execute getattr append };
    class process { transition };
}

# Define a new domain and executable type
type tpi_exec_t;
type tpi_exec_exec_t;

# Mark the executable type as a file type so it can be labeled and executed
files_type(tpi_exec_exec_t)

# Allow processes in tpi_exec_t to execute the binary labeled tpi_exec_exec_t
allow tpi_exec_t tpi_exec_exec_t:file { read open execute getattr append };

# Minimal self-transition (allows tpi_exec_t to spawn itself safely)
allow tpi_exec_t self:process transition;
